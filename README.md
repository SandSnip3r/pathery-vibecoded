# Pathery Puzzle Solver

This project provides a high-performance, Python-based platform for developing and comparing sophisticated solver algorithms for the game Pathery. It includes a flexible and extensible architecture that allows for the easy implementation and testing of new solvers.

## Installation

To get started, you'll need Python 3.8+ and a C++ compiler.

1.  **Create and activate a virtual environment:**
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```

2.  **Compile the C++ Pathfinding Library:**
    The core environment uses a C++ library for high-speed pathfinding calculations.
    ```bash
    make -C src/pathery_env/cpp_lib/
    ```

3.  **Install Dependencies and the Project:**
    Install the required Python packages and the project itself in "editable" mode. This allows you to edit the source code and have the changes immediately reflected without reinstalling.
    ```bash
    pip install -r requirements.txt
    pip install -e .
    ```

## User Tools

These are the main executables you'll use for solving and visualizing puzzles.

### Main Solver

The primary tool for solving puzzles. It can be run with various solvers and configurations.

**Usage:**
```bash
python src/pathery/main.py <puzzle_path> --solver <solver_name>
```

**Examples:**
```bash
# Solve puzzle_1.json with the default memetic solver
python src/pathery/main.py data/puzzles/puzzle_1.json

# Solve puzzle_3.json with the genetic solver and a 60-second time limit
python src/pathery/main.py data/puzzles/ucu/puzzle_3.json --solver genetic --time_limit 60
```
*For a full list of options, run with `--help`.*

### Puzzle Visualizer

A simple tool to render a puzzle file in the console.

**Usage:**
```bash
python scripts/visualize_puzzles.py <puzzle_path>
```

## Developer & Experimentation Tools

These scripts are used for collecting data, training models, and running benchmarks.

*   **`scripts/run_data_collection.py`**: Runs the genetic solver on a batch of puzzles to generate mutation data for training RL models.
*   **`scripts/combine_logs.py`**: Merges the parallel log files generated by the data collection script into a single file.
*   **`scripts/train_dqn.py`**: Trains the DQN (Deep Q-Network) agent using the data generated by the collection scripts.
*   **`scripts/benchmark.py`**: A script for measuring and comparing the performance of different solvers on a set of puzzles.

## Implemented Solvers

The project includes a variety of solver algorithms:

*   **`hill_climbing`**: A simple and fast local search algorithm that iteratively moves to better neighboring solutions.
*   **`simulated_annealing`**: A probabilistic algorithm that can escape local optima by sometimes accepting worse solutions, with the probability decreasing over time.
*   **`genetic`**: A standard genetic algorithm that evolves a population of solutions over generations using selection, crossover, and mutation.
*   **`hybrid_genetic`**: A more advanced genetic algorithm that uses a multiprocessing pool to calculate fitness in parallel for improved performance.
*   **`memetic`**: A hybrid algorithm that combines the global search capabilities of a genetic algorithm with the local refinement of a hill-climbing search.
*   **`dqn_genetic`**: An experimental solver that uses a pre-trained Deep Q-Network to guide the mutation process in a genetic algorithm.
*   **`focused_search`**: A beam search algorithm that explores a limited number of the most promising solutions at each step.

## Project Structure

The project is organized using a standard `src` layout to separate the core library code from scripts and tests.

*   **`src/pathery/`**: The main solver library, containing the core logic, solver implementations, and utilities.
*   **`src/pathery_env/`**: The self-contained `PatheryEnv` gymnasium environment.
*   **`data/puzzles/`**: Contains all puzzle definition files in JSON format.
*   **`scripts/`**: Contains all runnable scripts for users and developers.
*   **`tests/`**: Contains all unit and integration tests.
*   **`output/`**: The default directory for all generated files, such as logs and model checkpoints.
*   **`docs/`**: Project documentation and experiment notes.

## Bug Reports

Known bugs and issues are tracked in `bugs.md`. If you encounter a new issue, please consider adding it to this file.
